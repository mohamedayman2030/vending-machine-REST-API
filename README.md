# ğŸ¥¤ Vending Machine API

This is a secure, reliable, and extensible RESTful API for a **Vending Machine** system. It supports two user roles: **seller** and **buyer**, allowing sellers to manage products and buyers to deposit coins and purchase products.

---

## ğŸš€ Features

- âœ… RESTful JSON API
- âœ… Role-Based Access Control (RBAC)
- âœ… JWT Authentication
- âœ… Secure password encryption using **bcrypt**
- âœ… Full **ACID-compliant** transactions using Sequelize and Postgres
- âœ… Product locking during purchase to prevent race conditions
- âœ… Dockerized setup with PostgreSQL
- âœ… Middleware validation with **Joi**
- âœ… Postman collection with automated AI-written test cases

---

## ğŸ“¦ Project Structure

```
/models         â†’ Sequelize models for User, Product
/controllers    â†’ Handles business logic
/routes         â†’ Defines REST endpoints
/middlewares    â†’ JWT Auth, RBAC, Joi Validation
/validators     â†’ Joi schemas for each entity
/migrations     â†’ Sequelize migration files
/tests          â†’ Postman collection
```

---

## ğŸ› ï¸ Setup & Run

### 1. Environment Variables

Create a `.env` file based on the following structure:

```
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=vending_db
DB_HOST=postgres
JWT_SECRET=your_jwt_secret
```

### 2. Run the App

```bash
docker-compose up --build
```

The API will be running at:  
**http://localhost:3000**

---

## ğŸ” Authentication & Authorization

- Users authenticate using `username` and `password` (hashed using **bcrypt**).
- All secured endpoints require a valid JWT.
- Role-Based Access Control (RBAC):
  - **Sellers** can create, update, delete **their own products**
  - **Buyers** can deposit, buy, reset only their own account

---

## ğŸ’° Buyer-Specific Endpoints

| Endpoint      | Description                                      |
|---------------|--------------------------------------------------|
| POST /deposit | Accepts 5, 10, 20, 50, 100 cent coins only       |
| POST /buy     | Buys product(s), returns total, product, change |
| POST /reset   | Resets buyer's deposit to 0                      |

---

## ğŸ§ª API Testing

All endpoints are covered in the attached **Postman collection**, automatically generated by an AI agent.

ğŸ‘‰ [Postman Test Collection](#insert-link-here)

---

## ğŸ”® Suggested Future Improvements

1. **Caching**  
   Use Redis or similar for frequent product and user queries.

2. **Monitoring**  
   Integrate tools like **Datadog**, **Prometheus**, or **Sentry** for observability.

3. **LLM Agent Integration**  
   Add an LLM-based agent to interact with users (e.g., â€œWhatâ€™s the cheapest snack I can buy?â€).

---

## ğŸ“š Summary of Requirements

- REST API in JSON
- CRUD for:
  - Users (auth-free registration, secured updates/deletes)
  - Products (public read, sellers can manage their own)
- Buyers:
  - Deposit coins: 5, 10, 20, 50, 100 only
  - Purchase products (with coin change)
  - Reset their deposit
- Authorization by role
- All sensitive operations locked in **transactions**

---

## ğŸ“œ License

MIT â€” use freely, just give credit if this project helps you.
